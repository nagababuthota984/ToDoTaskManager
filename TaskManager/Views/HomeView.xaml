<UserControl x:Class="TaskManager.Views.HomeView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:TaskManager.Views"
             xmlns:validations="clr-namespace:TaskManager.Validations"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
             xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
             xmlns:cal ="http://www.caliburnproject.org"
             xmlns:models="clr-namespace:TaskManager.Models"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <UserControl.Resources>
        <!--<ObjectDataProvider x:Key="StatusOptions" MethodName="GetNames" ObjectType="{x:Type sys:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="models:Enums+Status"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>-->
    </UserControl.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition/>
            <ColumnDefinition/>
            <ColumnDefinition/>
            <ColumnDefinition />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition />
        </Grid.RowDefinitions>
        <TextBox Grid.Column="1" Grid.ColumnSpan="2" x:Name="SearchKeyword"  Margin="4" mah:TextBoxHelper.Watermark="Search tasks by name.." Padding="5" mah:TextBoxHelper.ClearTextButton="True" mah:TextBoxHelper.UseFloatingWatermark="False" mah:TextBoxHelper.SelectAllOnFocus="True" Background="#F7F7F7"
                     cal:Message.Attach="[Event TextChanged]=[Action SearchTasks]"/>
        <Grid x:Name="PriorityIndicators" Grid.Column="3" >
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>


            <Button Grid.Column="2" x:Name="SwitchToListView" Height="10" ToolTip="List view" Margin="2 ">
                <iconPacks:BootstrapIcons Kind="ListUl" Height="9"/>
            </Button>
            <Button Grid.Column="3" x:Name="SwitchToCardView" ToolTip="Card view" Height="10" Margin="2 2 20 2" >
                <iconPacks:BootstrapIcons Kind="CardList" Height="10"/>
            </Button>
            <Rectangle Grid.Column="5" Style="{StaticResource TM.PriorityIndicator.Low}"/>
            <TextBlock Grid.Column="6" Text="Low" VerticalAlignment="Center"/>
            <Rectangle  Grid.Column="7" Style="{StaticResource TM.PriorityIndicator.Medium}"/>
            <TextBlock Grid.Column="8" Text="Medium" VerticalAlignment="Center"/>
            <Rectangle Style="{StaticResource TM.PriorityIndicator.High}" Grid.Column="9" />
            <TextBlock Grid.Column="10" Text="High" VerticalAlignment="Center" Margin="0 0 10 0"/>
        </Grid>

        <Grid  Grid.Row="1" Name="CardView"  Grid.ColumnSpan="4" Style="{StaticResource TM.Grid.CardView}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition  />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition  />
                <ColumnDefinition />
                <ColumnDefinition  />
            </Grid.ColumnDefinitions>
            <TextBlock  Text="Create Task" Style="{StaticResource TM.TextBlock.PrimaryHeading}"
                   Margin="15 0 0 0" Foreground="Black" Background="White"/>
            <TextBlock   Grid.Column="1"
                   Text="New" Style="{StaticResource TM.TextBlock.PrimaryHeading}"  />
            <TextBlock   Grid.Column="2"
                   Text="In Progress" Style="{StaticResource TM.TextBlock.PrimaryHeading}"/>
            <TextBlock   Grid.Column="3"
                   Text="Completed" Style="{StaticResource TM.TextBlock.PrimaryHeading}" />
            <Border BorderBrush="Black" BorderThickness="1" Grid.Row="2">
                <Grid x:Name="InputForm" Grid.Row="2" Margin="15" >
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="Name" Style="{StaticResource TM.TextBlock.FormLabels}" Padding="0 0 4 4"/>
                    <TextBox Grid.Row="1" mah:TextBoxHelper.Watermark="Please enter task name">
                        <Binding Path="Name">
                            <Binding.ValidationRules>
                                <validations:NameValidation/>
                            </Binding.ValidationRules>
                        </Binding>
                    </TextBox>
                    <TextBlock Grid.Row="2" Text="Description" Margin="0 10 0 0" Style="{StaticResource TM.TextBlock.FormLabels}"/>
                    <TextBox Grid.Row="3" mah:TextBoxHelper.Watermark="Give a brief description about the task"
                         x:Name="Description" Height="50"  TextWrapping="Wrap"/>
                    <TextBlock Grid.Row="4" Text="Status"  Style="{StaticResource TM.TextBlock.FormLabels}"/>
                    <ComboBox Grid.Row="5" x:Name="StatusOptions" SelectedItem="{Binding SelectedStatus}"/>
                    <TextBlock Grid.Row="6" Text="Due Date"   Style="{StaticResource TM.TextBlock.FormLabels}"/>
                    <mah:DateTimePicker Grid.Row="7" SelectedDateTime="{Binding DueDate,UpdateSourceTrigger=PropertyChanged}"  />
                    <TextBlock Grid.Row="8"  Text="Priority"  Style="{StaticResource TM.TextBlock.FormLabels}"/>
                    <WrapPanel Name="PriorityRadioButtons" Grid.Row="9" >
                        <RadioButton Style="{StaticResource TM.RadioButton.DefaultStyle}"
                        IsChecked="{Binding SelectedPriority, Converter={StaticResource TM.Converters.EnumToBooleanConverter},
                        ConverterParameter=0}" Content="Low"/>
                        <RadioButton Style="{StaticResource TM.RadioButton.DefaultStyle}"
                        IsChecked="{Binding SelectedPriority, Converter={StaticResource TM.Converters.EnumToBooleanConverter},
                        ConverterParameter=1}" Content="Medium"/>
                        <RadioButton Style="{StaticResource TM.RadioButton.DefaultStyle}"
                        IsChecked="{Binding SelectedPriority, Converter={StaticResource TM.Converters.EnumToBooleanConverter},
                        ConverterParameter=2}" Content="High"/>
                    </WrapPanel>
                    <TextBlock Grid.Row="10" Text="Task Category" Style="{StaticResource TM.TextBlock.FormLabels}"/>
                    <WrapPanel Grid.Row="11">
                        <RadioButton  Style="{StaticResource TM.RadioButton.DefaultStyle}" Content="New Feature"
                                 IsChecked="{Binding SelectedCategory, Converter={StaticResource TM.Converters.EnumToBooleanConverter},
                                   ConverterParameter=0}"/>
                        <RadioButton  Style="{StaticResource TM.RadioButton.DefaultStyle}" Content="Bug Fix"
                                 IsChecked="{Binding SelectedCategory, Converter={StaticResource TM.Converters.EnumToBooleanConverter},
                                   ConverterParameter=1}"/>
                        <RadioButton  Style="{StaticResource TM.RadioButton.DefaultStyle}" Content="Learning task"
                                 IsChecked="{Binding SelectedCategory, Converter={StaticResource TM.Converters.EnumToBooleanConverter},
                                   ConverterParameter=2}"/>
                        <RadioButton  Style="{StaticResource TM.RadioButton.DefaultStyle}" Content="Others"
                                 IsChecked="{Binding SelectedCategory, Converter={StaticResource TM.Converters.EnumToBooleanConverter},
                                   ConverterParameter=3}"/>
                    </WrapPanel>
                    <TextBlock Text="% Complete" Grid.Row="12" 
                           Visibility="{Binding SelectedStatus, Converter={StaticResource TM.Converters.StatusToVisibilityConverter}}"
                            Style="{StaticResource TM.TextBlock.FormLabels}"/>
                    <Slider Grid.Row="13"  Value="{Binding PercentageComplete}"  
                        Visibility="{Binding SelectedStatus, Converter={StaticResource TM.Converters.StatusToVisibilityConverter}}"
                        IsSnapToTickEnabled="True"
                        TickPlacement="BottomRight" 
                        TickFrequency="20" 
                        Maximum="100" 
                        Minimum="0"
                        ToolTip="{Binding PercentageComplete}"/>
                    <Grid x:Name="CreateCancelButtons" Grid.Row="14" Margin="0 15 0 0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*"/>
                            <ColumnDefinition Width="2*"/>
                            <ColumnDefinition Width="2*"/>
                        </Grid.ColumnDefinitions>
                        <Button Grid.Column="1" x:Name="CreateOrUpdateTask" Content="{Binding SubmitBtnContent}" MinWidth="40"  
                            Background="#16A05D" Foreground="White" Margin="0 0 5 0" Style="{StaticResource TM.Button.DefaultStyle}"/>
                        <Button Grid.Column="2" x:Name="Cancel" Content="Cancel" Background="#E0E0E0" 
                            Style="{StaticResource TM.Button.DefaultStyle}"
                            cal:Message.Attach="[Event Click] = [Action ResetInputControls()]" />
                    </Grid>
                </Grid>
            </Border>

            <Border BorderBrush="Black" Grid.Column="1" Grid.Row="2" BorderThickness="0 1 1 1" >
                <ListBox x:Name="NewList" Grid.Row="2" Grid.Column="1" DataContext="{Binding}" 
                     ItemsSource="{Binding FilteredNewTasks}"
                     cal:Message.Attach="[Event MouseMove] = [Action MouseMoveHandler($eventArgs)];
                     [Event Drop] = [Action DropOnNewTasks($eventArgs)]"
                     Style="{Binding NewTasks.Count,Converter={StaticResource TM.Converters.ItemsCountToStyleConverter},ConverterParameter=0}"
                     ItemTemplate="{StaticResource TM.ListBox.TaskCardViewTemplate}"
                     ItemContainerStyle="{StaticResource TM.ListBox.ListBoxItemStyle}"/>
            </Border>

            <Border BorderBrush="Black" Grid.Row="2" Grid.Column="2" BorderThickness="0 1 1 1">
                <ListBox x:Name="InProgressList" Grid.Row="2" Grid.Column="2" DataContext="{Binding}" 
                     ItemsSource="{Binding FilteredInProgressTasks}" 
                     Style="{Binding InProgressTasks.Count,Converter={StaticResource TM.Converters.ItemsCountToStyleConverter},ConverterParameter=1}"
                     cal:Message.Attach="[Event MouseMove] = [Action MouseMoveHandler($eventArgs)];
                     [Event Drop] = [Action DropOnInProgressTasks($eventArgs)]"
                      ItemTemplate="{StaticResource TM.ListBox.TaskCardViewTemplate}"
                     ItemContainerStyle="{StaticResource TM.ListBox.ListBoxItemStyle}"/>
            </Border>

            <Border BorderBrush="Black" Grid.Row="2" Grid.Column="3" BorderThickness="0 1 1 1">
                <ListBox x:Name="CompletedList" Grid.Row="2" Grid.Column="3" DataContext="{Binding}"
                     ItemsSource="{Binding FilteredCompletedTasks}"
                     Style="{Binding CompletedTasks.Count,Converter={StaticResource TM.Converters.ItemsCountToStyleConverter},ConverterParameter=2}"
                     cal:Message.Attach="[Event Drop] = [Action DropOnCompletedTasks($eventArgs)]"
                     ItemTemplate="{StaticResource TM.ListBox.TaskCardViewTemplate}"
                     ItemContainerStyle="{StaticResource TM.ListBox.ListBoxItemStyle}"/>
            </Border>
        </Grid>
        <Grid Grid.Row="1" Grid.ColumnSpan="4">
            <Grid.RowDefinitions>
                <RowDefinition Height="4*"/>
                <RowDefinition Height="2*"/>
            </Grid.RowDefinitions>
            <ListView BorderThickness="0" Name="ListView" Grid.ColumnSpan="4" ItemsSource="{Binding FilteredTasks}"
                  Style="{StaticResource TM.ListView.DefaultStyle}" ItemContainerStyle="{StaticResource TM.ListView.ItemContainerStyle}" >
                <ListView.View >
                    <GridView  ColumnHeaderContainerStyle="{StaticResource TM.GridView.ColumnHeaderStyle}"  >
                        <GridViewColumn  Header="Task Name" DisplayMemberBinding="{Binding Name}" Width="200" />
                        <GridViewColumn  Header="Description" Width="400" DisplayMemberBinding="{Binding Description,Converter={StaticResource TM.Converters.DescriptionToMessageConverter}}"/>
                        <GridViewColumn Header="Status" Width="200" DisplayMemberBinding="{Binding Status,Converter={StaticResource TM.Converters.EnumToDescriptionConverter}}"/>
                        <GridViewColumn Header="Priority" Width="200">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <TextBlock Text="{Binding Priority,Converter={StaticResource TM.Converters.EnumToDescriptionConverter}}" Foreground="{Binding Priority,Converter={StaticResource TM.Converters.PriorityToColorConverter}}"/>
                                    </Grid>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                        <GridViewColumn Header="Category" Width="200" DisplayMemberBinding="{Binding Category,Converter={StaticResource TM.Converters.EnumToDescriptionConverter}}"/>
                        <GridViewColumn Header="Due on" Width="200">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <TextBlock Text="{Binding DueDate,Converter={StaticResource TM.Converters.DateTimeToStringConverter}}" Foreground="{Binding DueDate,Converter={StaticResource TM.Converters.DueDateToColorConverter}}"/>
                                    </Grid>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn  Width="110" CellTemplate="{StaticResource TM.ListView.EditDeleteButtonsTemplate}" />
                    </GridView>
                </ListView.View>
            </ListView>
            <WrapPanel Grid.Row="1" HorizontalAlignment="Right">
                <TextBlock Text="Items shown per page: " Style="{StaticResource TM.TextBlock.BoldLabels}" Margin="3" Padding="5"/>
                <TextBox  Margin="3 3 20 3" mah:TextBoxHelper.SelectAllOnFocus="True" >
                    <Binding Path="ItemsPerPage" UpdateSourceTrigger="PropertyChanged" >
                        <Binding.ValidationRules>
                            <validations:IntegerValidation/>
                        </Binding.ValidationRules>
                    </Binding>
                </TextBox>
                <Button x:Name="NavigatePrevious"  Foreground="White" Padding="5" Width="30" Margin="3" Background="{StaticResource TM.Colors.PrimaryColor}" Style="{StaticResource TM.Button.DefaultStyle}">
                    <Button.Content>
                        <iconPacks:BootstrapIcons Kind="ArrowLeft"/>
                    </Button.Content>
                </Button>
                <TextBlock Text="Page" Margin="3" Padding="5"/>
                <TextBox  Margin="3" mah:TextBoxHelper.SelectAllOnFocus="True" cal:Message.Attach="[Event PreviewKeyUp]=[Action LoadCurrentPage()]">
                    <Binding Path="CurrentPageNumber" UpdateSourceTrigger="PropertyChanged" >
                        <Binding.ValidationRules>
                            <validations:IntegerValidation/>
                        </Binding.ValidationRules>
                    </Binding>

                </TextBox>
                <TextBlock Text="of" Padding="5" Margin="0 3 0 3"/>
                <TextBox x:Name="TotalPagesCount"  Text="1" IsEnabled="False" Margin="3"/>
                <Button x:Name="NavigateNext"  Foreground="White" Padding="5" Width="30" Margin="3" Background="{StaticResource TM.Colors.PrimaryColor}" Style="{StaticResource TM.Button.DefaultStyle}">
                    <Button.Content>
                        <iconPacks:BootstrapIcons Kind="ArrowRight"/>
                    </Button.Content>
                </Button>
                <WrapPanel.Style>
                    <Style TargetType="WrapPanel">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsListViewEnabled}" Value="True">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </WrapPanel.Style>
            </WrapPanel>

        </Grid>

    </Grid>

</UserControl>